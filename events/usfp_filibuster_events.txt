namespace = usfp_filibuster

#William Walker attacks Sonora
usfp_filibuster.1 = {
	type = country_event
	placement = scope:baja_scope

	event_image = {
		video = "africa_construction_colony"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_military.dds"
	
	title = usfp_filibuster.1.t
	desc = usfp_filibuster.1.d
	flavor = usfp_filibuster.1.f
	dlc = dlc_usfp
	duration = 3

	trigger = {
		game_date > 1853.1.1
		game_date < 1865.1.1 
		usfp_manifest_destiny_greater_or_equal_trigger = { value = 4 }
		NOT = {
			exists = c:SON
		}
		NOT = {
			has_global_variable = had_walker_sonora
		}
		exists = c:MEX
		c:MEX = {
			NOT = {
				is_subject_of = c:USA
			}
			owns_entire_state_region = STATE_BAJA_CALIFORNIA
			owns_entire_state_region = STATE_SONORA
		}
		s:STATE_CALIFORNIA = {
			root_has_state_here = yes
			region_state:USA = {
				any_neighbouring_state = {
					state_region = s:STATE_BAJA_CALIFORNIA
				}
			}
		}
		is_at_war = no
	}

	immediate = {
		set_global_variable = had_walker_sonora
		s:STATE_SONORA.region_state:MEX = {
			save_scope_as = sonora_state_scope
		}
		s:STATE_BAJA_CALIFORNIA.region_state:SON = {
			save_scope_as = baja_scope
		}
		c:MEX = {
			save_scope_as = mexico_scope
			trigger_event = {
				id = usfp_filibuster.2
				popup = yes
			}
			create_country = {
				tag = SON
				state = s:STATE_BAJA_CALIFORNIA.region_state:MEX
				origin = c:MEX
				on_created = {
					save_scope_as = sonora_scope
					s:STATE_SONORA = {
						add_claim = c:SON
					}
					create_character = {
						template = usfp_usa_william_walker
						ruler = yes
						is_general = yes
					}
					activate_law = law_type:law_autocracy
					set_country_type = unrecognized
				}
			}
			c:SON = {
				create_diplomatic_play = {
					type = dp_return_state
					target_state = scope:sonora_state_scope
					target_country = c:MEX
				}
				create_military_formation = {
					type = army
					hq_region = sr:region_pacific_coast
					name = "Walker's Expedition"
					combat_unit = {
						type = unit_type:combat_unit_type_irregular_infantry
						state_region = s:STATE_BAJA_CALIFORNIA
						count = 1
					}
				}
				capital = {
					create_pop = {
						culture = dixie
						size = 300 #LMAO
						pop_type = soldiers
					}
				}
				save_scope_as = sonora_scope
				ruler = {
					save_scope_as = william_walker_scope
				}
				add_modifier = {
					name = usfp_filibusters_modifier
					years = 4
				}
			}
		}

	}

	#bad!
	option = {
		name = usfp_filibuster.1.a
		default_option = yes
		change_relations = {
			country = c:SON
			value = -20
		}
	}
	#hmmm
	option = {
		name = usfp_filibuster.1.b
		change_relations = {
			country = c:MEX
			value = -10
		}
	}
	#support!
	option = {
		name = usfp_filibuster.1.c
		highlighted_option = yes
		usfp_manifest_more_destiny_effect = yes
		trigger = {
			OR = {
				usfp_manifest_destiny_greater_or_equal_trigger = { value = 6 }
				ruler = {
					usfp_manifest_destiny_pro_expansion_trigger = yes
				}
			}
		}
		change_relations = {
			country = c:SON
			value = 50
		}
		create_diplomatic_pact = {
			country = c:SON
			type = protectorate
		}
		change_relations = {
			country = c:MEX
			value = -50
		}
		create_incident = {
			country = c:MEX
			value = 10
		}
		random_diplomatic_play = {
			limit = {
				initiator_is = c:SON
				target_is = c:MEX
			}
			add_initiator_backers = {
				root
			}
		}
		hidden_effect = {
			c:SON = {
				set_country_type = colonial
			}
		}
		set_variable = supported_sonora
	}
}
#MEX - William Walker in Sonora
usfp_filibuster.2 = {
	type = country_event
	placement = scope:baja_scope

	event_image = {
		video = "africa_construction_colony"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_military.dds"
	
	title = usfp_filibuster.2.t
	desc = usfp_filibuster.2.d
	flavor = usfp_filibuster.2.f
	dlc = dlc_usfp
	duration = 3

	immediate = {
		c:USA = {
			save_scope_as = usa_scope
		}
		s:STATE_BAJA_CALIFORNIA.region_state:SON = {
			save_scope_as = baja_scope
		}
	}

	#to arms!
	option = {
		name = usfp_filibuster.2.a
		default_option = yes
		ai_chance = {
			base = 1000
		}
		change_relations = {
			country = c:SON
			value = -100
		}
		s:STATE_BAJA_CALIFORNIA = {
			add_claim = root
		}
		random_diplomatic_play = {
			limit = {
				initiator_is = c:SON
				target_is = c:MEX
			}
			add_war_goal = {
				holder = root
				type = return_state
				target_state = s:STATE_BAJA_CALIFORNIA.region_state:SON
				primary_demand = yes
			}
		}
	}
}
#Sonora defeated
usfp_filibuster.3 = {
	type = country_event
	placement = scope:california_scope

	event_image = {
		video = "votp_hostile_court"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_military.dds"
	
	title = usfp_filibuster.3.t
	desc = usfp_filibuster.3.d
	flavor = usfp_filibuster.3.f
	dlc = dlc_usfp
	duration = 3

	immediate = {
		s:STATE_CALIFORNIA.region_state:USA = {
			save_scope_as = california_scope
		}
	}

	#okay
	option = {
		name = usfp_filibuster.3.a
		default_option = yes
		scope:california_scope = {
			add_loyalists_in_state = {
				value = small_radicals
				culture = cu:yankee
			}
		}
		custom_tooltip = {
			text = usfp_filibuster.3.a.t
		}
		ai_chance = {
			base = 100
		}
	}
	#lock him up!!
	option = {
		name = usfp_filibuster.3.b
		usfp_manifest_less_destiny_high_effect = yes
		scope:california_scope = {
			add_radicals_in_state = {
				value = small_radicals
				culture = cu:yankee
			}
		}
		set_global_variable = walker_imprisoned
		trigger = {
			ruler = {
				usfp_manifest_destiny_not_pro_expansion_trigger = yes
			}
		}
		every_interest_group = {
			limit = {
				OR = {
					leader = {
						usfp_manifest_destiny_pro_expansion_trigger = yes
					}
					is_interest_group_type = ig_landowners
				}
			}
			add_modifier = {
				name = usfp_rejected_filibustering
				years = 2
			}
		}
		ai_chance = {
			base = 100
		}
	}

}
#Sonora successful?!
usfp_filibuster.4 = {
	type = country_event
	placement = scope:sonora_scope.capital

	event_image = {
		video = "ep1_transfer_of_authority"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_military.dds"
	
	title = usfp_filibuster.4.t
	desc = usfp_filibuster.4.d
	flavor = usfp_filibuster.4.f
	dlc = dlc_usfp
	duration = 3

	immediate = {
		c:SON = {
			save_scope_as = sonora_scope
			ruler = {
				save_scope_as = william_walker_scope
			}
		}
	}

	#annex
	option = {
		name = usfp_filibuster.4.a
		default_option = yes
		annex = c:SON
		s:STATE_SONORA = {
			add_claim = c:MEX
		}
		ai_chance = {
			base = 100
		}
	}
	#puppet
	option = {
		name = usfp_filibuster.4.b
		create_diplomatic_pact = {
			country = c:SON
			type = puppet
		}
		s:STATE_SONORA = {
			add_claim = c:MEX
		}
		ai_chance = {
			base = 5
		}
	}
	#disavow
	option = {
		name = usfp_filibuster.4.c
		trigger = {
			NOT = {
				has_variable = supported_sonora
			}
		}
		change_relations = {
			country = c:SON
			value = -20
		}
		s:STATE_SONORA = {
			add_claim = c:MEX
		}
		every_interest_group = {
			limit = {
				OR = {
					leader = {
						usfp_manifest_destiny_pro_expansion_trigger = yes
					}
					is_interest_group_type = ig_landowners
				}
			}
			add_modifier = {
				name = usfp_rejected_filibustering
				years = 2
			}
		}
		ai_chance = {
			base = 0
		}
	}
}
#USA: Sponsor Narciso López?
usfp_filibuster.5 = {
	type = country_event
	placement = scope:cuba_state_scope

	event_image = {
		video = "ip3_officer_inspecting_peasant_conscripts"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_military.dds"
	
	title = usfp_filibuster.5.t
	desc = usfp_filibuster.5.d
	flavor = usfp_filibuster.5.f
	dlc = dlc_usfp
	duration = 3
	cooldown = { days = never_fire_again_modifier_time } #Once

	trigger = {
		game_date > 1850.1.1
		game_date < 1865.1.1 
		NOR = {
			has_state_in_state_region = STATE_WESTERN_CUBA
			has_state_in_state_region = STATE_CENTRAL_CUBA
			has_state_in_state_region = STATE_EASTERN_CUBA
		}
		NOT = {
			has_law_or_variant = law_type:law_slavery_banned
		}
		has_journal_entry = je_acw_countdown
		is_at_war = no
		usfp_manifest_destiny_greater_or_equal_trigger = { value = 5 }
		exists = c:CUB
		c:CUB = {
			is_subject = yes
		}
	}

	immediate = {
		s:STATE_WESTERN_CUBA = {
			random_scope_state = {
				save_scope_as = cuba_state_scope
			}
		}
		c:CUB = {
			save_scope_as = cuba_scope
			overlord = {
				save_scope_as = cuban_overlord
			}
		}
	}

	#turn blind eye
	option = {
		name = usfp_filibuster.5.a
		default_option = yes
		scope:cuba_scope = {
			trigger_event = {
				id = usfp_filibuster.6
				months = 6
			}
		}
		ai_chance = {
			base = 100
		}
	}
	#support
	option = {
		name = usfp_filibuster.5.b
		trigger = {
			ruler = {
				usfp_manifest_destiny_pro_expansion_trigger = yes
			}
		}
		highlighted_option = yes
		show_as_unavailable = {
			always = yes
		}
		scope:cuba_scope = {
			trigger_event = {
				id = usfp_filibuster.7
				months = 6
				popup = yes
			}
		}
		ai_chance = {
			base = 0
		}
	}
	#arrest
	option = {
		name = usfp_filibuster.5.c
		every_interest_group = {
			limit = {
				OR = {
					leader = {
						usfp_manifest_destiny_pro_expansion_trigger = yes
					}
					is_interest_group_type = ig_landowners
				}
			}
			add_modifier = {
				name = usfp_rejected_filibustering
				years = 2
			}
		}
		add_lobby_appeasement_from_diplomacy_unidirectional = {
			FIRST = root
			SECOND = scope:cuban_overlord
			PRO_AMOUNT = 2
			ANTI_AMOUNT = -2
			FACTOR = appeasement_special_events_negative
		}
		ai_chance = {
			base = 0
			modifier = {
				trigger = {
					ruler = {
						usfp_manifest_destiny_pro_expansion_trigger = yes
					}
				}
				add = 100
			}
		}
	}
}
#CUB: Narciso López captured
usfp_filibuster.6 = {
	type = country_event
	placement = scope:cuba_state_scope

	event_image = {
		video = "ep1_redcoats"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_military.dds"
	
	title = usfp_filibuster.6.t
	desc = usfp_filibuster.6.d
	flavor = usfp_filibuster.6.f
	dlc = dlc_usfp
	duration = 3

	immediate = {
		c:USA = {
			save_scope_as = usa_scope
		}
		random_scope_character = {
			limit = {
				OR = {
					is_interest_group_type = ig_armed_forces
					is_commander = yes
				}
			}
			save_scope_as = general_scope
		}
	}

	#execute
	option = {
		name = usfp_filibuster.6.a
		default_option = yes
		change_relations = {
			country = c:USA
			value = -15
		}
		overlord = {
			change_relations = {
				country = c:USA
				value = -15
			}
		}
		c:USA = {
			post_notification = usfp_cuba_filibusters_failed
		}
		add_loyalists = {
			value = medium_radicals
			culture = cu:caribeno
			strata = upper
		}
		add_liberty_desire = -15
		ai_chance = {
			base = 100
		}
	}

	#repatriate
	option = {
		name = usfp_filibuster.6.b
		add_radicals = {
			value = medium_radicals
			culture = cu:caribeno
			strata = upper
		}
		add_liberty_desire = 10
		ai_chance = {
			base = 0
		}
	}

	after = {
		scope:general_scope = {
			add_modifier = {
				name = usfp_celebrated_commander_modifier
				years = 5
			}
		}
	}

}
#CUB/SPA: Narciso López attacks
usfp_filibuster.7 = {
	type = country_event
	placement = scope:filibuster_country_scope.capital

	event_image = {
		video = "ep1_redcoats"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_military.dds"
	
	title = usfp_filibuster.7.t
	desc = usfp_filibuster.7.d
	flavor = usfp_filibuster.7.f
	dlc = dlc_usfp
	duration = 3

	immediate = {
		if = {
			limit = {
				this = c:CUB
			 }
			 create_country = {
				tag = usfp_F_CUB
				origin = c:USA
				province = p:xB325C7
				on_created = {
					activate_law = law_type:law_autocracy
					set_ruling_interest_groups = {
						ig_armed_forces
					}
					create_military_formation = {
						type = army
						hq_region = root.capital.region
						combat_unit = {
							type = unit_type:combat_unit_type_irregular_infantry
							state_region = s:STATE_WESTERN_CUBA
							count = 1 #LMAO
						}
					}
					create_character = {
						template = usfp_narciso_lopez
						ruler = yes
						is_general = yes
					}
					capital = {
						create_pop = {
							culture = caribeno
							size = 500
							pop_type = soldiers
						}
						create_pop = {
							culture = caribeno
							size = 100
							pop_type = officers
						}
					}
					add_modifier = {
						name = usfp_filibusters_modifier
						years = 2
					}
					change_relations = {
						country = c:CUB
						value = -100
					}
					change_relations = {
						country = c:CUB.overlord
						value = -100
					}
					change_relations = {
						country = c:USA
						value = 100
					}
					set_secret_goal = {
						country = c:CUB
						secret_goal = conquer
					}
				}
			}
			overlord = {
				trigger_event = {
					id = usfp_filibuster.7
					popup = yes
				}
			}
		}
		c:usfp_F_CUB = {
			ruler = {
				save_scope_as = lopez_scope
			}
			save_scope_as = filibuster_country_scope
		}
	}

	#to arms!
	option = {
		name = usfp_filibuster.7.a
		default_option = yes
		change_relations = {
			country = c:USA
			value = -30
		}
		if = {
			limit = {
				this = c:CUB
			 }
			 c:usfp_F_CUB = {
				create_diplomatic_play = {
				type = dp_revolution
				target_state = c:CUB.capital
				annex_as_civil_war = yes
				escalation = 80

				# add_war_goal = {
				# 	holder = c:CUB
				# 	type = return_state
				# 	target_state = c:usfp_F_CUB.capital
				# }
			}
		}
		} else = {
			show_as_tooltip = {
				create_diplomatic_play = {
					type = dp_annex_war
					target_country = c:CUB
					escalation = 80

					add_war_goal = {
						holder = c:CUB
						type = return_state
						target_state = c:usfp_F_CUB.capital
					}
				}
			}
		}
	}

}
#USA: Lopez successful??
usfp_filibuster.8 = {
	type = country_event
	placement = scope:filibuster_country_scope.capital

	event_image = {
		video = "africa_construction_colony"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_military.dds"
	
	title = usfp_filibuster.8.t
	desc = usfp_filibuster.8.d
	flavor = usfp_filibuster.8.f
	dlc = dlc_usfp
	duration = 3

	immediate = {
		c:usfp_F_CUB = {
			save_scope_as = filibuster_country_scope
		}
	}

	#annex
	option = {
		name = usfp_filibuster.8.a
		default_option = yes
		annex = c:usfp_F_CUB
		usfp_manifest_more_destiny_effect = yes
		if = {
			limit = {
				NOT = {
					has_law_or_variant = law_type:law_slavery_banned
				}
			 }
			 usfp_anger_abolitionists_effect = {  MULT = 3}
		}
		ai_chance = {
			base = 100
		}
	}
	#puppet
	option = {
		name = usfp_filibuster.8.b
		usfp_manifest_more_destiny_effect = yes
		create_diplomatic_pact = {
			country = c:usfp_F_CUB
			type = puppet
		}
		c:usfp_F_CUB = {
			add_liberty_desire = -100
			change_tag = CUB
		}
		ai_chance = {
			base = 0
		}
	}
	#disavow
	option = {
		name = usfp_filibuster.8.b
		usfp_manifest_less_destiny_effect = yes
		change_relations = {
			country = c:usfp_F_CUB
			value = -20
		}
		c:usfp_F_CUB = {
			change_tag = CUB
		}
		every_interest_group = {
			limit = {
				OR = {
					leader = {
						usfp_manifest_destiny_pro_expansion_trigger = yes
					}
					is_interest_group_type = ig_landowners
				}
			}
			add_modifier = {
				name = usfp_rejected_filibustering
				years = 2
			}
		}
		ai_chance = {
			base = 0
		}
	}

}